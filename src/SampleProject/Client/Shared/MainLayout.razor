@inherits LayoutComponentBase

@using System.Linq

@inject IJSRuntime jsRuntime
@inject HttpClient http


<BxBlazor.Components.UIShell.BxUIShell prefix="bx" HeaderNavLinks="HeaderNavLinks" HeaderActions="HeaderActions" SwitcherLinks="SwitcherLinks" NavSections="Sections">
    @Body
</BxBlazor.Components.UIShell.BxUIShell>

@code {
    IEnumerable<HeaderNavLink> HeaderNavLinks;
    IEnumerable<SwitcherLink> SwitcherLinks;
    IEnumerable<NavMenuSection> Sections;
    IEnumerable<HeaderAction> HeaderActions;

    protected override async Task OnInitializedAsync()
    {
        var shell_structure = new { Sections = Sections, SwitcherLinks = SwitcherLinks, HeaderNavLinks = HeaderNavLinks, HeaderActions = HeaderActions };

        var result = Newtonsoft.Json.JsonConvert.DeserializeAnonymousType(Globals.UIShellStructure, shell_structure);

        Sections = result.Sections;
        HeaderNavLinks = result.HeaderNavLinks;
        SwitcherLinks = result.SwitcherLinks;
        HeaderActions = result.HeaderActions;

        await base.OnInitializedAsync();
    }

    private Dictionary<string, SidenavItem[]> NavigationSections = new Dictionary<string, SidenavItem[]>()
    {
        {
                "Demos",
                new SidenavItem[] {
                    new SidenavItem {
                        DisplayText = "Home",
                        Expanded = false,
                        HasChilds = false,
                        Link = "/"
                    },
                    new SidenavItem {
                        DisplayText = "Fetch Data",
                        Expanded = false,
                        HasChilds = false,
                        Link = "/fetchdata"
                    },
                    new SidenavItem {
                        DisplayText = "Counter",
                        Expanded = false,
                        HasChilds = false,
                        Link = "/counter"
                    },
                    new SidenavItem {
                        DisplayText = "Components",
                        Expanded = false,
                        HasChilds = true,
                        ChildItems = new SidenavItem[]
            {
                            new SidenavItem {
                                DisplayText = "BxAccordion",
                                Link = "components/bx-accordion"
                            },
                            new SidenavItem {
                                DisplayText = "BxDataTable",
                                Link = "components/bx-datatable"
                            },
                            new SidenavItem {
                                DisplayText = "BxModal",
                                Link = "components/bx-modal"
                            },
                            new SidenavItem {
                                DisplayText = "BxTabs",
                                Link = "components/bx-tabs"
                            },
                            new SidenavItem {
                                DisplayText = "BxStructuredList",
                                Link = "components/bx-structuredlist"
                            },
                            new SidenavItem {
                                DisplayText = "BxCodeSnippet",
                                Link = "components/bx-codesnippet"
                            }
                        }
                    }
                }
            }
    };

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {

        await base.OnAfterRenderAsync(firstRender);
    }
}
